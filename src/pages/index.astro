---
import Container from "@components/container.astro";
import Layout from "@layouts/Layout.astro";
import { getCollection } from "astro:content";
import Link from "@components/ui/link.astro";
import { Picture } from "astro:assets";
import meImage from "../assets/me2sq.png";

const basePath = import.meta.env.BASE_URL;
const posts = await getCollection("blog", ({ data }) => {
  return !data.draft && data.publishDate < new Date();
});

posts.sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf());
const latestPosts = posts.slice(0, 3);
---

<Layout title="Dave Huntley - Building Teams, Shipping Software">
  <Container>
    <div class="max-w-7xl mx-auto">
      <!-- Hero Section -->
      <div class="grid lg:grid-cols-12 gap-12 items-center py-16">
        <div class="lg:col-span-8">
          <h1 class="text-6xl lg:text-7xl font-bold tracking-tight leading-none">
            Building Great Teams.<br/>
            Shipping Better<br/>
            Software.
          </h1>
          <p class="text-lg text-slate-600 mt-8 mb-8">
            CTO and software engineer with a track record of building exceptional teams and delivering transformative results. From real-time systems handling millions of users to leading enterprise-wide digital transformations, I focus on what actually matters: getting brilliant software into production.
          </p>
          <div class="flex flex-col sm:flex-row gap-3">
            <Link href={`${basePath}/blog`} class="flex gap-1 items-center justify-center">
              Read My Blog
            </Link>
            <Link
              size="lg"
              style="outline"
              href="https://github.com/Stimul8d"
              class="flex gap-1 items-center justify-center"
              target="_blank">
              Find Me on GitHub
            </Link>
          </div>
        </div>
        <div class="lg:col-span-4">
          <div class="w-full aspect-square overflow-hidden rounded-lg shadow-lg">
            <Picture
              src={meImage}
              alt="Dave Huntley"
              widths={[400]}
              sizes="400px"
              class="w-full h-full object-cover object-center grayscale"
            />
          </div>
        </div>
      </div>

      <!-- About Section -->
      <div class="py-16 border-t">
        <h2 class="text-3xl font-bold mb-12">About Me</h2>
        <div class="grid lg:grid-cols-3 gap-12">
          <div>
            <h3 class="text-xl font-semibold mb-4">Build & Scale Teams</h3>
            <p class="text-slate-600">Bootstrapped multi-million pound software departments from scratch and transformed struggling teams into high-performing units.</p>
          </div>
          <div>
            <h3 class="text-xl font-semibold mb-4">Deliver Real Results</h3>
            <p class="text-slate-600">From handling 15M concurrent users for betting platforms to building IoT solutions for modern parking operations.</p>
          </div>
          <div>
            <h3 class="text-xl font-semibold mb-4">Bridge the Gap</h3>
            <p class="text-slate-600">Technically sharp and business savvy. I translate between engineers and stakeholders, keeping everyone focused on what actually matters.</p>
          </div>
        </div>
      </div>

      <!-- Blog Section -->
      {latestPosts.length > 0 && (
        <div class="py-16 border-t">
          <h2 class="text-3xl font-bold mb-12">Latest Thoughts</h2>
          <div class="space-y-12">
            {latestPosts.map((post) => (
              <article>
                <h3 class="text-2xl font-semibold mb-2">
                  <a href={`${basePath}/blog/${post.slug}`} class="hover:text-blue-600">
                    {post.data.title}
                  </a>
                </h3>
                <time class="text-slate-500" datetime={post.data.publishDate.toISOString()}>
                  {post.data.publishDate.toDateString()}
                </time>
                {post.data.tags && (
                  <div class="flex gap-2 mt-2">
                    {post.data.tags.map((tag) => (
                      <span class="text-sm text-slate-500">#{tag}</span>
                    ))}
                  </div>
                )}
              </article>
            ))}
          </div>
        </div>
      )}
    </div>
  </Container>
</Layout>