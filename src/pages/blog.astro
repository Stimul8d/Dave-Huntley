---
import Layout from "@layouts/Layout.astro";
import Container from "@components/container.astro";
import { getCollection } from "astro:content";

const posts = await getCollection('blog', ({ data }) => !data.draft);

const practical = posts.filter(post => post.data.category === "Practical Leadership").sort((a, b) => a.data.order - b.data.order);
const agile = posts.filter(post => post.data.category === "Making Agile Work").sort((a, b) => a.data.order - b.data.order);
const lean = posts.filter(post => post.data.category === "Lean Thinking").sort((a, b) => a.data.order - b.data.order);
const engineering = posts.filter(post => post.data.category === "Engineering Excellence").sort((a, b) => a.data.order - b.data.order);
---

<Layout title="Blog">
  <Container>
    <div class="py-8">
      {[
        { 
          title: "Practical Leadership",
          description: "Leadership stripped of buzzwords and corporate theatre. Real insights about what actually works, backed by experience rather than theory.",
          posts: practical 
        },
        { 
          title: "Making Agile Work",
          description: "Cut through the agile marketing noise and certification circus. Practical approaches to delivery that focus on outcomes over orthodoxy.",
          posts: agile 
        },
        { 
          title: "Lean Thinking",
          description: "Strategic tools and techniques that drive real alignment. Not just theoryâ€”concrete approaches that create meaningful change.",
          posts: lean 
        },
        { 
          title: "Engineering Excellence",
          description: "Build better software by focusing on what matters. Clear thinking about complexity, quality, and the real challenges of shipping code.",
          posts: engineering 
        }
      ].map(section => (
        <div class="mb-16">
          <h2 class="text-4xl font-bold mb-2 px-4">{section.title}</h2>
          <p class="text-gray-600 mb-8 px-4">{section.description}</p>
          <div class="relative">
            <div class="flex overflow-x-auto pb-8 relative">
              {section.posts.map(post => (
                <div class="flex-none w-[400px] mr-6 first:ml-4">
                  <a href={`/Dave-Huntley/blog/${post.slug}`} class="block group">
                    <div class="bg-gray-50 rounded-xl shadow overflow-hidden transition duration-200 ease-in-out transform group-hover:shadow-lg group-hover:scale-[1.02]">
                      <img 
                        src={`/Dave-Huntley/blog/${post.slug}.jpg`}
                        alt={post.data.title}
                        class="h-[225px] w-full object-cover filter grayscale transition duration-200 ease-in-out group-hover:grayscale-0"
                      />
                      <div class="p-6">
                        <h3 class="text-xl font-bold mb-3 leading-tight min-h-[3.5rem]">{post.data.title}</h3>
                        <p class="text-gray-600 line-clamp-2 leading-relaxed">{post.data.summary}</p>
                      </div>
                    </div>
                  </a>
                </div>
              ))}
            </div>
            <div class="absolute right-0 top-0 bottom-8 w-32 pointer-events-none bg-gradient-to-l from-white to-transparent"></div>
          </div>
        </div>
      ))}
    </div>
  </Container>
</Layout>